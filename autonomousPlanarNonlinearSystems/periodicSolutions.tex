\documentclass{ximera}

\input{../preamble.tex}

\title{Periodic Solutions}

\begin{document}
\begin{abstract}
\end{abstract}
\maketitle

 \label{S:periodic}
\index{periodic solution}

A periodic solution to a system of differential equations 
\begin{equation}  \label{e:genlveceqn}  
\frac{dX}{dt} = F(X)
\end{equation}
is a nonconstant solution such that 
\begin{equation}  \label{e:period}
X(t)=X(t+T)
\end{equation}
for some positive real number $T$.  The smallest positive number $T$
satisfying \eqref{e:period} is called the {\em period\/}\index{period} 
of the periodic solution.  The {\em frequency\/}\index{frequency} is 
the quantity $1/T$.
 
Uniqueness of solutions\index{uniqueness of solutions} to the initial 
value problem has an interesting consequence concerning periodic solutions.
\begin{lemma}  
Let $X(t)$ be a nonconstant solution to the autonomous
system \eqref{e:genlveceqn} such that 
\[
X(T)=X(0).
\]
Then $X(t)$ is a periodic solution with period dividing $T$.
\end{lemma}

\begin{proof}  Let $Y(t)=X(t+T)$.  Then $Y(t)$ is a solution to 
\eqref{e:genlveceqn} since 
\[
\dot{Y}(t) = \dot{X}(t+T)=F(X(t+T))=F(Y(t)).
\]
This solution has initial condition $Y(0)=X(T)=X(0)$.  
Uniqueness of solutions with the same initial condition 
implies that $X(t)=Y(t)$ for all $t$ and that $X(t)=X(t+T)$.
Since $X(t)$ is not an equilibrium, there is a smallest 
positive period for $X$ and that period must divide $T$. \end{proof}

In this section we study two types of planar systems that have periodic 
solutions, centers and phase--amplitude equations, and in both examples 
we prove that the system has periodic solutions.  Typically, however, 
proving that periodic solutions exist is not a simple task; in general 
we rely on numerical solution to verify existence of periodic solutions..




\subsubsection*{Nonhyperbolic Centers}

Nonconstant periodic solutions occur in linear systems only when the
coefficient matrix has purely imaginary eigenvalues, that is,
when the origin is a center.  Therefore, periodic solutions
occur in linear systems only when the equilibrium is
nonhyperbolic, and they occur in infinite families.  For
example, consider the {\em center\/}  \index{center}
\begin{equation}  \label{e:planeper}
\frac{dX}{dt} = \mattwo{0}{-\tau}{\tau}{0}X.
\end{equation}
Solutions of \eqref{e:planeper} are 
\[
X(t) = \mattwo{\cos(\tau t)}{-\sin(\tau t)}{\sin(\tau t)}
{\cos(\tau t)}X_0.
\]
All nonzero solutions of \eqref{e:planeper} are periodic with period
$2\pi/\tau$.  See Figure~\ref{F:planarperiodic}.

\begin{figure}[htb]
           \centerline{%
           \psfig{file=../figures/periodic.eps,width=3.5in}
           \psfig{file=../figures/period2.eps,width=3.5in}}
           \caption{(Left) Trajectories of \protect\eqref{e:planeper}
	     when $\tau=3$. (Right) A time series of one solution.}
           \label{F:planarperiodic}
\end{figure}

Centers are examples of nonhyperbolic\index{nonhyperbolic}
equilibria\index{equilibrium!nonhyperbolic}, and higher
order terms will change the 
phase portrait of a center\index{phase!portrait!for a center} --- even
near the origin.  For example, consider the system  \index{hyperbolic}
\begin{matlabEquation}  \label{e:nonlincenter}
\begin{array}{rcl}
\dot{x} & = & -2y -(x^2+y^2)x \\
\dot{y} & = & 2x - (x^2+y^2)y.
\end{array}
\end{matlabEquation}
A trajectory in the phase portrait of \eqref{e:nonlincenter} that
spirals into the origin is shown in Figure~\ref{F:nonlincenter}
(left). Equation \eqref{e:nonlincenter} can be modified to produce
a single periodic solution, as follows:
\begin{matlabEquation}  \label{e:nonlincenter2}
\begin{array}{rcl}
\dot{x} & = & x-2y -(x^2+y^2)x \\
\dot{y} & = & 2x+y - (x^2+y^2)y.
\end{array}
\end{matlabEquation}
See Figure~\ref{F:nonlincenter} (right).  This example shows the necessity 
of assuming hyperbolicity as a hypothesis in Theorem~\ref{T:linearization}.  

\begin{figure}[htb]
           \centerline{%
           \psfig{file=../figures/period3.eps,width=3.5in}
	   \psfig{file=../figures/period4.eps,width=3.5in}}
           \caption{(Left) A trajectory of \protect\eqref{e:nonlincenter}
that spirals towards the origin. Note the slow convergence due to the fact 
that the origin is not hyperbolic.  (Right) A trajectory of 
\protect\eqref{e:nonlincenter2} that spirals towards a periodic solution.}
           \label{F:nonlincenter}
\end{figure}

\subsection*{Phase -- Amplitude Equations}
\index{phase-amplitude equations}

We now show why equations \eqref{e:nonlincenter},\eqref{e:nonlincenter2} 
behave as observed in the numerical integration.  We do this using 
polar coordinates\index{polar coordinates} and phase-amplitude equations.  
Recall that rectilinear coordinates $(x,y)$ can be written in terms 
of polar coordinates $(r,\theta)$ as
\begin{eqnarray*}
x & = & r\cos\theta\\
y & = & r\sin\theta.
\end{eqnarray*}
On inverting these equations we find that
\arraystart
\begin{equation} \label{e:polarccord}
\begin{array}{lcl}
r^2 & = & x^2+y^2  \\
\theta & = & \dps\tan\inv\left(\frac{y}{x}\right). 
\end{array}
\end{equation}
\arrayfinish
In applications, $r$ is called the {\em amplitude\/}\index{amplitude} and 
$\theta$ the {\em phase\/}.\index{phase}

Suppose that $(x(t),y(t))$ is the solution to a planar system of
ODEs of the form 
\begin{equation} \label{e:HopfNF}
\begin{array}{rcl}
\dot{x} & = & a(x^2+y^2)x - b(x^2+y^2)y\\
\dot{y} & = & a(x^2+y^2)y + b(x^2+y^2)x,
\end{array}
\end{equation}
where $a$ and $b$ are differentiable functions of $x^2+y^2$.
Note that \eqref{e:nonlincenter} and \eqref{e:nonlincenter2} are special cases 
of \eqref{e:HopfNF}.  In \eqref{e:nonlincenter} $a(r^2)=-r^2$ and $b(r^2)=2$, 
while in \eqref{e:nonlincenter2} $a(r^2)=1-r^2$ and $b(r^2)=2$.

Applying the chain rule\index{chain rule} to \eqref{e:polarccord}, we obtain 
\arraystart
\begin{equation}  \label{e:polarder}
\begin{array}{rcl}
\dot{r} & = & \dps\frac{1}{r}\left(x\dot{x} + y\dot{y}\right)\\ 
\dot{\theta} & = & \dps\frac{1}{r^2}\left(x\dot{y}-y\dot{x}\right).
\end{array}
\end{equation}
\arrayfinish
Substitute the values of $\dot{x}$ and $\dot{y}$ from \eqref{e:HopfNF} into 
\eqref{e:polarder} to obtain the 
{\em amplitude\/} equation\index{amplitude!equation}
\begin{equation} \label{e:amplitude}
\frac{dr}{dt}  =  a(r^2) r
\end{equation}
and the {\em phase\/} equation\index{phase!equation}
\begin{equation} \label{e:phase}
\frac{d\theta}{dt} =  b(r^2).
\end{equation}

\begin{proposition}
Suppose that $r_0$ is a positive zero of the amplitude equation, that is,
$a(r_0^2)=0$.  If $b(r_0^2)\neq 0$, then the circle $r=r_0$ is the
trajectory\index{trajectory} of a periodic solution to \eqref{e:HopfNF}.  

Moreover, if $a'(r^2_0)<0$ then the periodic solution is asymptotically 
stable; if $a'(r^2_0)>0$ then the periodic solution is unstable.
\end{proposition}\index{stability!asymptotic}\index{periodic solution}

\begin{proof}  The function $r(t)$ measures how far the solution $(x(t),y(t))$ to
\eqref{e:HopfNF} is from the origin.  Thus, if $r_0$ is a positive zero of the 
amplitude equation, then the distance of the solution remains constant; that
is, the trajectory of $(x(t),y(t))$ in the plane lies on the circle $r=r_0$
(or $x^2+y^2=r^2$ in Cartesian coordinates).  The solution to the phase 
equation corresponding to this amplitude equilibrium is 
$\theta(t)=b(r_0^2)t+\theta_0$.  Therefore, if $b(r_0^2)\neq 0$, then the 
solution trajectory moves around the circle $r=r_0$ with nonzero constant 
speed.

To verify the statement on asymptotic stability, write the amplitude 
equation as 
\[
\dot{r} = a(r^2)r \equiv f(r).
\]
The point $r_0>0$ is an equilibrium for the amplitude equation if $f(r_0)=0$, 
that is, if $a(r_0^2)=0$.  That equilibrium is asymptotically stable if 
$f'(r_0)<0$.  Using the product rule and the chain rule we see that 
\[
f'(r) = a'(r^2)2r^2 +a(r^2).
\]
Therefore
\[
f'(r_0) = 2r_0^2a'(r_0^2).
\]
It follows that $f'(r_0)<0$ if and only if $a'(r_0^2)<0$.
  
If $a'(r^2_0)<0$, then the equilibrium of the amplitude equation is 
asymptotically stable and nearby trajectories to the planar periodic solution
limit on that periodic solution $r=r_0$ in forward time.  \end{proof} 



\subsubsection*{The Two Examples}

As noted, in both equations \eqref{e:nonlincenter} and \eqref{e:nonlincenter2}
$b(r^2) = 2$.  In the first equation $a(r^2) = -r^2$, while in
the second equation $a(r^2)=1-r^2$.  In both equations, the
phase equation is
\[
\frac{d\theta}{dt} = 2,
\]
that is solved for $\theta = 2t + \theta_0$ for some initial
$\theta_0$.  Thus all solutions spin around the origin
counterclockwise at a constant speed.  In \eqref{e:nonlincenter}
the amplitude equation is
\[
\frac{dr}{dt} = -r^3,
\]
and all solutions approach $r=0$ in forward time.  Thus, the 
phase-amplitude equations together imply that all solutions 
to \eqref{e:nonlincenter} spiral into the origin, even though the 
origin in the linearized equations is a center. 

In \eqref{e:nonlincenter2} the amplitude equation is 
\[
\frac{dr}{dt} = r-r^3.
\]
In this equation all solutions with positive initial $r$ tend towards 
$r=1$, the unit circle in the $xy$-plane.  This is seen using the one
dimensional phase line: note that there is only one positive equilibrium at 
$r=1$ and that solutions diverge from $0$ and $\infty$.  Thus, the 
phase-amplitude equations\index{phase-amplitude equations} show that 
all solutions (except the origin) spiral in forward time counterclockwise 
into the unit circle (that is a periodic solution).

\subsection*{Limit Cycles}
\index{limit cycle}

In general, for nonlinear systems without special structure, 
we do not expect periodic solutions to come in continuous families.
We do expect periodic solutions to be isolated --- as in 
Figure~\ref{F:globalb} (left).  

We call a periodic solution $x(t)$ a {\em limit cycle\/} if all 
nearby trajectories converge to $x(t)$ in forward time or all nearby
solutions converge to $x(t)$ in backward time.  Note that in phase 
space a limit cycle is always isolated; in particular, a limit cycle 
cannot be included in a continuous family of periodic solutions as 
happens in \eqref{e:planeper}.

\begin{theorem} \label{T:PB}
Suppose that the right hand side of a planar system of differential 
equations is defined and smooth everywhere inside a periodic solution.  
Then there is an equilibrium inside the periodic solution.
\end{theorem} 
\index{periodic solution!equilibrium inside}

This theorem is a consequence of the celebrated Poincar\'e-Bendixson theorem
\index{Poincar\'e-Bendixson theorem} and simplifies the search for limit 
cycles in the plane; limit cycles must surround at least one equilibrium.  
Again, the most important information for determining the dynamics of a given 
planar differential equation is the number and type of equilibria.  Once the 
equilibria are known, more complicated features, such as periodic 
solutions and stable and unstable orbits at saddles, can be found by 
exploration.

\EXER

\TEXER

\noindent In Exercises~\ref{c8.3.1a} -- \ref{c8.3.1c} use phase -- amplitude 
equations to determine the number of limit cycles that the given system of 
differential equations has.   Then sketch the phase portrait of this 
differential equation.
\begin{exercise} \label{c8.3.1a}
\[
\begin{array}{rcl}
\dot{x} & = &  3x-5y - 4(x^2+y^2)x + (x^2+y^2)^2x\\
\dot{y} & = &  5x+3y - 4(x^2+y^2)y + (x^2+y^2)^2y
\end{array} 
\]

\begin{solution}

\ans The system has two limit cycles, one at $r = 1$ and one at $r =
\sqrt{3}$, where $r$ is the radius of the circle made by the limit cycle.

\soln Write the differential equation in the form of \eqref{e:HopfNF}:
\[ \begin{array}{rcl}
\dot{x} & = & a(x^2 + y^2)x - b(x^2 + y^2)y \\
\dot{y} & = & a(x^2 + y^2)y + b(x^2 + y^2)x \end{array}
\]
where $a(r^2) = 3 - 4r^2 + r^4=(r^2-3)(r^2-1)$ and $b(r^2) = 5$.  Then,
rewrite the system in polar coordinates by calculating $\dot{r}$ and
$\dot{\theta}$ using \eqref{e:amplitude} and \eqref{e:phase} from the
chapter:
\[ \begin{array}{rcccl}
\dot{r} & = & a(r^2)r & = & (3 - 4r^2 + r^4)r \\
\dot{\theta} & = & b(r^2) & = & 5 \end{array}
\]
A limit cycle occurs at any positive equilibrium of $\frac{dr}{dt}$.
Solve for $r$ in the first equation to find that equilibria occur
at $r = 1$ and $r = \sqrt{3}$.  Then graph the system.  Your drawing
should resemble the {\tt pplane5} graph shown in Figure~\ref{c8.3.1a}.

\begin{figure}[htb]
                       \centerline{%
                       \psfig{file=exfigure/8-3-1.eps,width=3.0in}}
                \exercap{c8.3.1a}
\end{figure}


\end{solution}
\end{exercise}
\begin{exercise} \label{c8.3.1b}
\[ 
\begin{array}{rcl}
\dot{x} & = &  -5x-3y + 4(x^2+y^2)x + (x^2+y^2)^2x\\
\dot{y} & = &  3x-5y + 4(x^2+y^2)y + (x^2+y^2)^2y
\end{array}
\]

\begin{solution}

\ans The system has one limit cycle at $r = 1$.

\soln Write the differential equation in the form of \eqref{e:HopfNF},
where $a(r^2) = -5 + 4r^2 + r^4=(r^2+5)(r^2-1)$ and $b(r^2) = 3$.  Then,
rewrite the system in polar coordinates by calculating $\dot{r}$ and
$\dot{\theta}$ using \eqref{e:amplitude} and \eqref{e:phase} from the
chapter:
\[ 
\begin{array}{rcccl}
\dot{r} & = & a(r^2)r & = & (-5 + 4r^2 + r^4)r \\
\dot{\theta} & = & b(r^2) & = & 3 \end{array}
\]
A limit cycle occurs at any positive equilibrium of $\frac{dr}{dt}$.
Solve for $r$ in the first equation to find that a positive equilibrium 
occurs at $r = 1$.  Then graph the system.  Your drawing should resemble the 
{\tt pplane5} graph shown in Figure~\ref{c8.3.1b}.

\begin{figure}[htb]
                       \centerline{%
                       \psfig{file=exfigure/8-3-1b.eps,width=3.0in}}
                \exercap{c8.3.1b}
\end{figure}


\end{solution}
\end{exercise}
\begin{exercise} \label{c8.3.1c}
\[ 
\begin{array}{rcl}
\dot{x} & = &  6x-y - 5(x^2+y^2)x - 2(x^2+y^2)y + (x^2+y^2)^2x\\
\dot{y} & = &  x+6y - 5(x^2+y^2)y + 2(x^2+y^2)x + (x^2+y^2)^2y
\end{array}
\]

\begin{solution}

\ans The system has two limit cycles, one at $r = \sqrt{2}$ and one
at $r = \sqrt{3}$. 

\soln Write the differential equation in the form of \eqref{e:HopfNF}
where $a(r^2) = 6 - 5r^2 + r^4=(r^2-3)(r^2-2)$, and 
$b(r^2) = 1+2r^2$.  Then,
rewrite the system in polar coordinates by calculating $\dot{r}$ and
$\dot{\theta}$ using \eqref{e:amplitude} and \eqref{e:phase} from the
chapter:
\[ 
\begin{array}{rcccl}
\dot{r} & = & a(r^2)r & = & (-5 + 4r^2 + r^4)r \\
\dot{\theta} & = & b(r^2) & = & 1+2r^2 \end{array}
\]
A limit cycle occurs at any positive equilibrium of $\frac{dr}{dt}$.
Solve for $r$ in the first equation to find that a positive equilibrium 
occurs at $r = \sqrt{2}$ and $r = \sqrt{3}$.  Then graph the system.  Your 
drawing should resemble the {\tt pplane5} graph shown in Figure~\ref{c8.3.1c}.

\begin{figure}[htb]
                       \centerline{%
                       \psfig{file=exfigure/8-3-1c.eps,width=3.0in}}
                \exercap{c8.3.1c}
\end{figure}


\end{solution}
\end{exercise}

\begin{exercise} \label{c8.3.4}
Use phase -- amplitude equations to find a system of differential equations 
that has exactly three limit cycles.

\begin{solution}

\soln A sample system of differential equations has the form of 
\eqref{e:HopfNF}, where $a(r^2) = (r^2-1)(r^2-2)(r^2-3)$
and $b(r^2) = 1$.

\soln  Choose any system of differential equations that has the form of 
\eqref{e:HopfNF} where $a(r^2)$ has three positive roots
and $b(r^2)$ is nowhere zero.


\end{solution}
\end{exercise}

\begin{exercise} \label{c8.3.5}
An autonomous planar system of differential equations is a {\em gradient\/} 
\index{gradient} system if there exists a real-valued differentiable function 
$f(x,y)$ such that 
\begin{equation} \label{E:gradsys}
\begin{array}{rcl}
\dot{x} & = & f_x(x,y) \\
\dot{y} & = & f_y(x,y).
\end{array}
\end{equation}
Prove that gradient systems never have periodic solutions.  

{\bf Hint:} Proceed in four steps as follows.
\begin{itemize}
\item[(a)]  Let $(x(t),y(t))$ be a solution to \eqref{E:gradsys} and let 
$h(t)=f(x(t),y(t))$.  So $h:\R\to\R$.  Use the chain rule to show that 
$h'(t)\geq 0$.
\item[(b)]  Show that $h'(t_0) = 0$ for some $t_0$ if and only if 
$(x(t),y(t)$ is an equilibrium of  \eqref{E:gradsys}.
\item[(c)]  Show that $h$ is monotonic increasing along any nonconstant 
solution of \eqref{E:gradsys}. 
\item[(d)]  Explain why a nonconstant solution of \eqref{E:gradsys} cannot be 
periodic.
\end{itemize}

\begin{solution}

\soln (a)  Use the chain rule to calculate
\[
\dot{h} = f_x\dot{x}+f_y\dot{y}.
\]
Using the gradient system of differential equations, observe that
\[
\dot{h} = f_x^2 + f_y^2\ge 0.
\]
(b) It follows from (a) that $\dot{h}(t_0)=0$ if and only if 
$f_x(x(t_0),y(t_0))=0$ and $f_y(x(t_0),y(t_0))=0$.  That is, 
$\dot{h}(t_0)=0$ if and only if $(x(t_0),y(t_0))$ is an equilibrium for the
gradient system.

\noindent (c) It follows from (b) that $\dot{h}$ is nowhere zero on a
nonconstant solution and from (a) that $\dot{h}(t)>0$ on a nonconstant
solution.  Therefore, $h(t)$ is monotonic increasing along any nonconstant
solution.

\noindent (d)  If $(x(t),y(t)$ is a nonconstant periodic solution of the
gradient system with period $T>0$, then $h(t+T)=h(t)$ for all $t$.  Thus,
$h(t)$ is not monotonic along this solution, contradicting (c).  Therefore,
nonconstant periodic solutions of gradient systems cannot exist.  

\end{solution}
\end{exercise}



\CEXER

\begin{exercise} \label{c8.3.2}
Verify that the system of differential equations
\begin{matlabEquation} \label{8.3.2eq} 
\begin{array}{rcl}
\dot{x} & = & x-2y -(x^2+y^2)x + 0.1x^2\\
\dot{y} & = & 2x+y - (x^2+y^2)y - 0.2(y^2-x^2)
\end{array}
\end{matlabEquation}
has a single limit cycle.  Compare the phase portrait of this
equation with that of \eqref{e:nonlincenter2}.

\begin{solution}

Figure~\ref{c8.3.2} shows the {\tt pplane5} graph of \eqref{8.3.2eq}.
The system has a single equilibrium at the origin, so all limit cycles
must surround the origin.  We can verify visually that the system has
one limit cycle at $r = 1$.  The graph of this system is similar to
the graph of \eqref{e:nonlincenter2}, since both
have single equilibria at the origin and single stable limit cycles at
$r = 1$.

\begin{figure}[htb]
                       \centerline{%
                       \psfig{file=exfigure/8-3-2.eps,width=3.0in}}
                \exercap{c8.3.2}
\end{figure}

\end{solution}
\end{exercise}

\begin{exercise} \label{c8.3.3}
Verify that the system of differential equations
\begin{matlabEquation} \label{8.3.3eq} 
\begin{array}{rcl}
\dot{x} & = & x-2y + (x^2+y^2)^2x - 4x^3\\
\dot{y} & = & 2x+y + (x^2+y^2)^2y - 7(y^2-x^2)y
\end{array}
\end{matlabEquation}
has a single limit cycle in the square $-2.5\leq x,y \leq 2.5$.  How many 
equilibria does \eqref{8.3.3eq} have in this square?  

\begin{solution}

\ans There are nine equilibria in this square.

\soln  The equilibria found using {\sf pplane5} are:
\begin{verbatim}
(-0.7575, 0.3180)       Saddle point.            
(-1.9192, 0.0951)       Nodal source.            
(0.0000, 0.0000)        Spiral source.           
(1.9192, -0.0951)       Nodal source.            
(-0.7650, -1.2495)      Saddle point.            
(0.7650, 1.2495)        Saddle point.            
(0.7575, -0.3180)       Saddle point.            
(-0.1100, -2.6084)      Nodal source.            
(0.1100, 2.6084)        Nodal source.            
\end{verbatim}
See Figure~\ref{c8.3.3}.

\begin{figure}[htb]
                       \centerline{%
                       \psfig{file=exfigure/8-3-3.eps,width=3.0in}}
                \exercap{c8.3.3}
\end{figure}



\end{solution}
\end{exercise}

\end{document}
