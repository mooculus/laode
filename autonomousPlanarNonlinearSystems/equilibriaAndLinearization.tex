\documentclass{ximera}

\input{../preamble.tex}

\title{Equilibria and Linearization}

\begin{document}
\begin{abstract}
\end{abstract}
\maketitle

 \label{S:linearization}
\index{equilibrium}  \index{linearization}

Recall that equilibrium solutions of \eqref{e:nonlinear2}
are found by solving simultaneously the algebraic equations
\begin{equation}
\begin{array}{rcl} 
f(x,y) & = & 0 \\
g(x,y) & = & 0.
\end{array}
\end{equation}
In general, it is a difficult task to solve these algebraic
equations explicitly, except in the simplest of cases. One
example where an explicit solution may be found is
\eqref{e:globalexam}.  In that example, equilibria satisfy
\[
y  =  0 \AND x(2.2+x) = 0.
\]
Thus, there are two equilibria $Z_1=(0,0)$ and $Z_2=(-2.2,0)$
and these equilibria can be seen in Figure~\ref{F:globalb}.  We
know from our earlier discussion that the origin $Z_1$ is a
saddle point --- but what about the other equilibrium $Z_2$?
From the figure, it appears to be a spiral sink --- dynamics
that we associate with complex eigenvalues with negative real
parts.  See Table~\ref{T:hyperbolic} in Section~\ref{S:PlanarSystems}.  
In this section we discuss how we can apply linear theory to 
nonlinear equations. 

Let $F:\R^2\to\R^2$ be the nonlinear mapping 
\[
F(x,y)=(f(x,y),g(x,y)).
\]
\begin{definition}  \label{D:Jacobian}
The {\em Jacobian matrix} \index{matrix!Jacobian}
\index{matrix!Jacobian} of $F$ at the point 
$(x,y)$ is the $2\times 2$ matrix 
\begin{equation}  \label{e:jacobian}
(dF)_{(x,y)} = \mattwo{f_x(x,y)}{f_y(x,y)}{g_x(x,y)}{g_y(x,y)}
\end{equation}
where the subscript denotes partial differentiation.  For example, 
$f_x=\frac{\partial f}{\partial x}$.
\end{definition}

Near an equilibrium, the Jacobian matrix is the best {\em linear\/}
approximation\index{linear!approximation} to the mapping $F$.  
This statement can be formalized using 
Taylor series methods in two variables, but we just accept this fact here. 
\begin{definition}  \label{D:hyperbolic}
An equilibrium is {\em hyperbolic\/} if the eigenvalues of the 
Jacobian matrix have nonzero real part. 
\end{definition} \index{hyperbolic}\index{equilibrium!hyperbolic}

Note that it is easy to compute the Jacobian matrix for linear 
systems.  Indeed, for the linear differential equation
\begin{eqnarray*}
\dot{x} & = & ax+by \\ \dot{y} & = & cx+dy,
\end{eqnarray*}
the Jacobian matrix is just \index{matrix!Jacobian}
\[
(dF)_{(x,y)} = \mattwo{a}{b}{c}{d}
\]
and is independent of $x$ and $y$.  So, not surprisingly, the 
best linear approximation to a linear system is itself.

\begin{theorem} \label{T:linearization} \index{linearization}
Suppose that the system of differential equations
\eqref{e:nonlinear2} has a hyperbolic equilibrium at
$Z_0=(x_0,y_0)$.  Then, on a sufficiently small neighborhood of
$Z_0$, the phase plane for \eqref{e:nonlinear2} is the {\em
same\/} as the phase plane\index{phase!plane} of the system of 
linear differential equations
\begin{equation}  \label{e:linearizedeqn}
\vectwo{\dot{x}}{\dot{y}} = (dF)_{Z_0} \vectwo{x}{y}.
\end{equation}
\end{theorem}  \index{hyperbolic}\index{equilibrium!hyperbolic}
It is difficult to define precisely what we mean by the word
{\em same\/}. Roughly speaking, {\em same\/} means that near 
$Z_0$ there is a nonlinear change of coordinates that 
transforms the nonlinear equation into the linear one.

For example, the Jacobian matrix of \eqref{e:globalexam} at the
equilibrium $Z_2=(-2.2,0)$ is 
\[
(dF)_{Z_2} = \left.\mattwoc{0}{1}{2.2+2x+y}{2.1+x}\right|_{(x,y)=(-2.2,0)} 
= \mattwo{0}{1}{-2.2}{-0.1}.
\]
At the equilibrium $Z_2$ we may use \Matlab to show that the 
eigenvalues of $(dF)_{Z_2}$ are $-0.05\pm 1.4824i$, thus verifying 
that the equilibrium $Z_2$ is a spiral sink. \index{sink} 
It is instructive to use {\pplane}\index{\computer!pplane8} to 
show the phase plane of 
the linearized system\index{linearization}.  
(To show the linearization, click on the 
{\sf Find an equilibrium point} button under the {\sf solutions} 
button.  Then in the {\sf \PPLANE equilibrium point} window click 
on the {\sf display the linearization} button.)  The result is
shown in Figure~\ref{F:spiral} (left); compare this result 
with the phase plane picture in Figure~\ref{F:globalb} (left) 
near the spiral sink.

\begin{figure*}[htb]
           \centerline{%
	   \includegraphics[width=3.5in]{../figures/spirala.pdf}
           \includegraphics[width=3.0in]{../figures/spiralb.pdf}}
           \caption{(Left) Trajectory of \protect\eqref{e:linearizedeqn} 
	     near the spiral sink $Z_2$. (Right) The time series $x$ 
		versus $t$ for this solution.}
           \label{F:spiral}
\end{figure*}


There is an important corollary to Theorem~\ref{T:linearization}.
We say that an equilibrium is 
{\em linearly stable\/}\index{stability!linear}
if all of the eigenvalues of the Jacobian matrix have negative real part.

\begin{corollary} \label{C:linearstability}
An equilibrium that is linearly stable is asymptotically stable.
\end{corollary}  \index{stability!asymptotic} 

In Section~\ref{S:PlanarSystems} we discussed linear stability
of the origin for planar linear equations.  We showed (see
Theorem~\ref{T:linstab}) that in planar linear equations, linear
stability implies that the origin is asymptotically stable.  It
follows from Theorem~\ref{T:linearization} that the equilibrium
of the nonlinear equation is also asymptotically stable.  

\begin{remark} 
Generalizations of Theorem~\ref{T:linearization} and 
Corollary~\ref{C:linearstability} to $n$ dimensions are both valid. 
{\rm The Jacobian matrix -- the matrix of partial 
derivatives of the coordinate functions --- is now an $n\times n$
matrix.  In $n$ dimensions, {\em hyperbolicity\/} 
of an equilibrium means that no eigenvalue of the Jacobian matrix has 
zero real part, and {\em linear stability\/} of an equilibrium means 
that the real parts of all $n$ of the eigenvalues have negative real 
part.  See Chapter~\ref{C:HDS}, Theorem~\ref{T:linstab}.}
\end{remark} \index{hyperbolic} \index{matrix!Jacobian}

\subsection*{Important Features of Hyperbolic Equilibria}
\index{equilibrium!hyperbolic}

Theorem~\ref{T:linearization} states that a nonlinear autonomous
system of differential equations behaves like its linearization 
in a small neighborhood of a hyperbolic equilibrium.  To effectively
utilize this theorem, we need to know the important features of phase 
portraits for hyperbolic linear systems.  We now recall results of 
Section~\ref{S:PlanarSystems}.

\subsubsection*{Saddles}  \index{saddle}

Recall from Section~\ref{S:6.7} (see Definition~\ref{D:stablemfld})
that planar systems of linear differential equations with saddles at the 
origin have invariant lines (or eigendirections) called stable and unstable 
orbits.  One eigendirection corresponds to a negative eigenvalue and is 
the stable direction\index{stable!direction}, as solutions on that line 
tend to the origin in forward time.
The other eigendirection corresponds to a positive eigenvalue 
and is the unstable direction\index{unstable!direction}, as solutions on 
that line tend to the origin in backward time.

It follows from Theorem~\ref{T:linearization} that this structure is
approximately recreated in nonlinear systems on small neighborhoods of
saddles.  In particular, there are invariant curves for nonlinear systems 
defined near saddle equilibria.  The nonlinearities deform the invariant 
lines into invariant curves called {\em invariant manifolds\/}.  
\index{stable!manifold} \index{unstable!manifold}  These invariant manifolds 
are called {\em stable\/} and {\em unstable manifolds\/} or {\em stable\/} 
and {\em unstable orbits\/}\index{stable!orbit} \index{unstable!orbit}; 
stable orbits tend to the equilibrium in forward 
time and unstable orbits tend to the equilibrium in backward time.  See 
Figure~\ref{F:globalb} for an example. 

\subsubsection*{Sinks}   \index{sink}

In \eqref{e:globalexam} we have also seen that the spiraling behavior near a
spiral equilibrium is unaffected by higher order terms (see
Figure~\ref{F:globalb}); this remark is also a consequence of
Theorem~\ref{T:linearization}. Similarly, Theorem~\ref{T:linearization} 
guarantees that near an improper node\index{improper node} or a 
focus\index{focus}, higher order terms do not 
affect the local phase portrait of the nonlinear system.

\subsubsection*{An Example with Analytically Solvable Equilibria}

As an example, consider the system of ODEs
\arraystart
\begin{matlabEquation} \label{e1:exer}
\begin{array}{crcl}
(a) & \dps\frac{dx}{dt} & = & 1 + x - y^2  \\
(b) & \dps\frac{dy}{dt} & = & -1 +6y + x^2 - 5y^2 
\end{array}
\end{matlabEquation}
\arrayfinish
We find all of the equilibria of this system of differential
equations, and their type.  (The coefficients have been chosen
so that the calculations are feasible.  Nevertheless, it is
instructive to verify the details.)

Note that $x=y^2-1$ is the solution to \eqref{e1:exer}(a), which we
may substitute into \eqref{e1:exer}(b) to obtain
\[
y^4 - 7y^2 + 6y =0.
\]
The coefficients were chosen so that this polynomial factors
into 
\[
y(y-1)(y-2)(y+3) = 0.
\]
Thus there are four equilibria\index{equilibrium} and they are:
\[
(-1,0),\; (0,1),\; (3,2),\; (8,-3).
\]

We now determine the type of each equilibrium.  To do this,
observe that the Jacobian matrix\index{matrix!Jacobian} 
is:
\[
\left(\begin{array}{cc} 1 & -2y \\ 2x & 6-10y
\end{array}\right). 
\]
Evaluating the Jacobian matrix at the four equilibria, we obtain
\[
\mattwo{1}{0}{-2}{6}, \quad \mattwo{1}{-2}{0}{-4}, \quad
\mattwo{1}{-4}{6}{-14}, \quad \mattwo{1}{6}{16}{36}.
\]
The determinant\index{determinant}, trace\index{trace}, 
discriminant\index{discriminant}, and type of each of these
matrices is shown in Table~\ref{t:exertype}.
\begin{table}[htb]
\begin{center}
\begin{tabular}{|c|c|c|c|c|}
\hline
equilibria & det (d) & trace (t) & disc (D) & type \\
\hline
$(-1,0)$ & $6$ & $7$ & $25$ & nodal source \\
\hline
$(0,1)$ & $-4$ & --- & --- & saddle \\
\hline
$(3,2)$ & $10$ & $-13$ & 129 & nodal sink \\
\hline
$(8,-3)$ & $-60$ & --- & --- & saddle\\
\hline
\end{tabular}
\caption{Types of equilibria in Example~\protect\eqref{e1:exer}.}
\label{t:exertype}
\end{center}
\end{table}\index{nodal source}\index{saddle}\index{nodal sink}

Next we use the information about equilibria contained in 
Table~\ref{t:exertype} and {\pplane}
\index{\computer!pplane8} to compute numerically the 
phase portrait\index{phase!portrait} of equations \eqref{e1:exer}.  Using 
the {\sf Find the equilibrium} button, put circles around
the four equilibria.  (Remember to make the display screen large
enough --- say $-2\leq x \leq 10$ and $-4\leq y \leq 4$.) Also
let {\pplane} compute the stable and unstable orbits of
the two saddles, obtaining the picture in Figure~\ref{F:ex12}.
Once this picture is drawn we have a good idea of the phase
portrait --- note, in particular, the saddle sink and saddle
source connections.


\begin{figure}[htb]
           \centerline{%
           \includegraphics[width=3.5in]{../figures/ex12exam.pdf}}
		\caption{Equilibria and connections of \protect\eqref{e1:exer}.} 
           \label{F:ex12}
\end{figure}

\subsubsection*{An Example Where Equilibria are Not Analytically Solvable}

As a second example consider the system of differential
equations
\begin{matlabEquation} \label{e:gradexam}
\begin{array}{rcl}
\dot{x} & = & x + y + x^2 - y^2 + 0.1 \\
\dot{y} & = & y - 2xy + 0.5x^2 + y^2.
\end{array}
\end{matlabEquation}
It is difficult to find the equilibria in \eqref{e:gradexam} explicitly.
We can, however, construct the phase plane of this equation with the 
help of {\pplane}.  First we choose a square in which to display 
the direction field\index{direction field} --- say $-5\leq x,y \leq 5$. See 
Figure~\ref{F:gradexam} (left).  We then inspect the direction field 
for possible equilibria.  There is one equilibrium near the origin;  
when we use the {\pplane} search feature for equilibria by clicking 
on the origin, we find a spiral source. Similarly, using the search feature 
for equilibria by clicking along the negative $x$ axis leads to a saddle.  
Once a saddle is found, instructing {\pplane} to plot the stable and 
unstable orbits of this saddle helps to fill in the phase plane.  
Some experimentation yields the four equilibria and connecting stable 
and unstable orbits pictured on the right in Figure~\ref{F:gradexam}.
These equilibria, which are listed by {\pplane} using the {\sf List
computed equilibrium points} button, are:
\begin{verbatim}  
(-0.1066, -0.0047)      Spiral source.           
(-1.1368, -0.2110)      Saddle point.            
(3.2539, 4.2672)        Saddle point.            
(0.2752, -0.3372)       Saddle point.       
\end{verbatim}
It is this last picture that leads to the stylized phase plane portrait 
in Figure~\ref{F:gradexamstyle}. \index{stylized phase portrait}

\begin{figure*}[htb]
           \centerline{%
	   \includegraphics[width=3.2in]{../figures/saddlea.pdf}
           \includegraphics[width=3.2in]{../figures/saddleb.pdf}}
           \caption{(Left) Direction field of \protect\eqref{e:gradexam}.
	(Right) Phase plane with equilibria and stable orbits.}
           \label{F:gradexam}
\end{figure*}

\begin{figure}[htb]
           \centerline{%
           \includegraphics[width=3.in]{../figures/grad.pdf}}
           \caption{Stylized phase plane portrait of \protect\eqref{e:gradexam}.}
           \label{F:gradexamstyle}
\end{figure}



\includeexercises

\end{document}
