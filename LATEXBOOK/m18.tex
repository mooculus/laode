\chapter{Numerical Solutions of ODEs}

\subsection*{Section~\protect{\ref{sec:DNM}} A Description of Numerical Methods}
\rhead{sec:DNM}{A DESCRIPTION OF NUMERICAL METHODS}

\exer{c15.1.1} The solution to the initial value problem is
$x(t)=-2(t-t_0)$.  On the other hand, an application of Euler's method
with step size $h$ leads to
\[
\begin{array}{rcl}
x_0 & = & 0 \\
x_{k+1} & = & x_k + h (-2) = x_k - 2h\\
t_k & = & t_0 + kh.
\end{array}
\]
Hence
\[
\begin{array}{rcl}
x_0 & = & 0\\
x_1 & = & -2h\\
x_2 & = & -4h\\
 & \vdots & \\
x_k & = & -2kh,
\end{array}
\]
and
\[
x(t_k) = -2(t_k-t_0) = -2kh = x_k.
\]

\exer{c15.1.2} An application of the implicit trapezoidal rule to
the system \Ref{eq:numanalsys} leads to
\begin{eqnarray*}
\vectwo{x_{k+1}}{y_{k+1}} & = &  \vectwo{x_k}{y_k} +
\frac{h}{2} \left(\vectwo{f(t_k,x_k,y_k)}{g(t_k,x_k,y_k)}
+\vectwo{f(t_{k+1},x_{k+1},y_{k+1})}{g(t_{k+1},x_{k+1},y_{k+1})}\right)\\
t_{k+1} &=& t_k + h.
\end{eqnarray*}



\exer{c15.1.3a} \ans Yes.

\soln Set
\[
s=2,\quad b_1=0,\quad b_2=1,\quad c_1=0,\quad c_2=\frac{1}{2},\quad
a_{21}=\frac{1}{2}.
\]

\newpage
\exer{c15.1.3b} \ans No.

\soln $x_k+t_k$ is not allowed in the second argument of $f$.

\exer{c15.1.3c} \ans Yes.

\soln Set
\[
s=2,\quad b_1=\frac{1}{4},\quad b_2=\frac{3}{4},\quad
c_1=0,\quad c_2=\frac{2}{3},\quad a_{21}=\frac{2}{3}.
\]

\exer{c15.1.4}
(a) \ans $\dps\sum_{i=1}^s b_i = 1$.

\soln For the given initial value problem we have $f(t,x)=1$.
Therefore the general Runge-Kutta method takes the form
\[
t_{k+1} = t_k + h\AND x_{k+1} = x_k + h\sum_{i=1}^s b_i.
\]
On the other hand the solution to the initial value problem is
given by $x(t) = t-t_0$ and $x_1=x(t_1)$ implies
\[
h = x(t_1) = x_1 = 0+h\sum_{i=1}^s b_i.
\]
Division by $h$ leads to the desired result.

(b) For Euler's method we have $b_1=1$, for the modified Euler
method we have $b_1=b_2=\frac{1}{2}$, and for the fourth order
Runge-Kutta method $b_1=b_4 = \frac{1}{6}$,
$b_2 = b_3 = \frac{2}{6}$.  Hence in each case $\sum_{i=1}^s b_i=1$.

\exer{c15.1.4a} The first step in Euler's method is given by
\[
x_1 = x_0 + hf(t_0,x_0),
\]
and hence formula \Ref{eq:tfeul} implies that
\begin{eqnarray*}
x(t_1) &=&  x(t_0)+h\frac{dx}{dt}(t_0)+
\frac{h^2}{2}\frac{d^2x}{dt^2}(t_0+\theta h)\\
&=& x_0 + hf(t_0,x_0) +\frac{h^2}{2}\frac{d^2x}{dt^2}(t_0+\theta h)\\
&=& x_1 +\frac{h^2}{2}\frac{d^2x}{dt^2}(t_0+\theta h).
\end{eqnarray*}
The exact solution is $x(t)= 4e^{t-1}-t-1$ with the second order
derivative
\[
\frac{d^2x}{dt^2}(t) = 4e^{t-1}>0\quad \mbox{for all $t$.}
\]
It follows that $x(t_1) > x_1$.

\exer{c15.1.6} The following \Matlab commands reproduce
Figure~\ref{fig:eulimpr}:
\begin{verbatim}
h    = 0.05;
t(1) = 1;
x(1) = 2;
K    = 40;
for k = 1:K
   t(k+1) = t(k)+h;
   x(k+1) = x(k)+h*(x(k)+t(k));
end
plot(t,x,'o')
hold on
plot(t,x,'--')
s = 1 : 0.01 : 3;
y = 4*exp(s-1)-s-1;
plot(s,y)
\end{verbatim}

\exer{c15.1.5a} The following \Matlab commands approximate the
solution by

(i) Euler's method:
\begin{verbatim}
h    = 0.1;
t(1) = 2;
x(1) = 3;
K    = 20;
for k = 1:K
   t(k+1) = t(k)+h;
   x(k+1) = x(k)+h*1;
end
plot(t,x,'o')
hold on
plot(t,x,'--')
\end{verbatim}

(ii) The modified Euler method:
\begin{verbatim}
h    = 0.1;
t(1) = 2;
x(1) = 3;
K    = 20;
for k = 1:K
   t(k+1) = t(k)+h;
   y(k)   = x(k)+h*1;
   x(k+1) = x(k)+(h/2)*(1+1);
end
plot(t,x,'o')
hold on
plot(t,x,'--')
\end{verbatim}


\exer{c15.1.5b} The following \Matlab commands approximate the solution by

(i) Euler's method:
\begin{verbatim}
h    = 0.2;
t(1) = 1;
x(1) = 0.5;
K    = 10;
for k = 1:K
   t(k+1) = t(k)+h;
   x(k+1) = x(k)+h*x(k)*x(k);
end
plot(t,x,'o')
hold on
plot(t,x,'--')
\end{verbatim}

(ii)  The modified Euler method:
\begin{verbatim}
h    = 0.2;
t(1) = 1;
x(1) = 0.5;
K    = 10;
for k = 1:K
   t(k+1) = t(k)+h;
   y(k)   = x(k)+h*x(k)*x(k);
   x(k+1) = x(k)+(h/2)*(x(k)*x(k)+y(k)*y(k));
end
plot(t,x,'o')
hold on
plot(t,x,'--')
\end{verbatim}

\exer{c15.1.5c} The following \Matlab commands approximate the solution by

(i) Euler's method:
\begin{verbatim}
h    = 0.05;
t(1) = 1;
x(1) = -1;
K    = 40;
for k = 1:K
   t(k+1) = t(k)+h;
   x(k+1) = x(k)+h*t(k)*x(k);
end
plot(t,x,'o')
hold on
plot(t,x,'--')
\end{verbatim}

(ii) The modified Euler method:
\begin{verbatim}
h    = 0.05;
t(1) = 1;
x(1) = -1;
K    = 40;
for k = 1:K
   t(k+1) = t(k)+h;
   y(k)   = x(k)+h*t(k)*x(k);
   x(k+1) = x(k)+(h/2)*(t(k)*x(k)+t(k+1)*y(k));
end
plot(t,x,'o')
hold on
plot(t,x,'--')
\end{verbatim}



\exer{c15.1.7}
(a) The implicit Euler method applied to the given initial
value problem takes the form
\[
t_{k+1} = t_k + h\AND x_{k+1} = x_k + h x_{k+1}.
\]
We can solve the second equation  for $x_{k+1}$ and obtain
\[
x_{k+1} = \frac{x_k}{1-h}.
\]
The approximate solution is now obtained by the \Matlab commands
\begin{verbatim}
h    = 0.1;
t(1) = 0;
x(1) = 1;
K    = 20;
for k = 1:K
   t(k+1) = t(k)+h;
   x(k+1) = x(k)/(1-h);
end
plot(t,x,'o')
hold on
plot(t,x,'--')
\end{verbatim}

(b) The implicit trapezoidal rule applied to the given initial
value problem takes the form
\[
t_{k+1} = t_k + h\AND x_{k+1} = x_k + \frac{h}{2}(x_k+x_{k+1}).
\]
We can solve the second equation for $x_{k+1}$ and obtain
\[
x_{k+1} = \frac{1+\frac{h}{2}}{1-\frac{h}{2}}x_k.
\]
The approximate solution is now obtained by the \Matlab commands
\begin{verbatim}
h    = 0.1;
t(1) = 0;
x(1) = 1;
K    = 20;
for k = 1:K
   t(k+1) = t(k)+h;
   x(k+1) = (1+h/2)/(1-h/2)*x(k);
end
plot(t,x,'o')
hold on
plot(t,x,'--')
\end{verbatim}

\exer{c15.1.8} For the initial value problem \Ref{eq:eulexivp} the
fourth order Runge-Kutta method is given by
\[
t_{k+1} = t_k+h,\quad f_1= x_k + t_k,\quad
f_2 = t_k+\frac{h}{2} + x_k + \frac{h}{2}f_1,
\]
\[
f_3 = t_k+\frac{h}{2} + x_k + \frac{h}{2}f_2,\quad f_4 = t_k+h+x_k+hf_3,
\]
and
\[
x_{k+1} = x_k + \frac{h}{6}(f_1+2f_2+2f_3+f_4).
\]
Hence we can reproduce Figure~\ref{fig:rk1} using the following
\Matlab commands:
\begin{verbatim}
h    = 0.6;
t(1) = 1;
x(1) = 2;
K    = 20;
for k = 1:K
   t(k+1) = t(k)+h;
   f1 = x(k)+t(k);
   f2 = t(k)+h/2 + x(k)+h/2*f1;
   f3 = t(k)+h/2 + x(k)+h/2*f2;
   f4 = t(k)+h + x(k)+h*f3;
   x(k+1) = x(k)+h/6*(f1+2*f2+2*f3+f4);
end
plot(t,x,'o')
hold on
plot(t,x,'--')
s = 1 : 0.1 : 13;
y = 4*exp(s-1)-s-1;
plot(s,y)
\end{verbatim}
Using the m-file {\tt fexam.m},
\begin{verbatim}
function f=fexam(t,x)
f = x + t;
\end{verbatim}
we superimpose the approximate solution using {\tt ode45} by
\begin{verbatim}
[t,y] = ode45('fexam',[1 13],2);
plot(t,y)
\end{verbatim}
This result is also very accurate.

\exer{c15.1.9} The exact solution of the initial value problem
is given by $x(t) = \cos(t)$ and $y(t)=\sin(t)$.  Therefore the
solution describes a circle in the phase plane.

(a) Euler's method applied to the given initial value problem
takes the form
\[
\begin{array}{rcl}
\vectwo{x_{k+1}}{y_{k+1}} & = &
\vectwo{x_k}{y_k} + h \vectwo{-y_k}{x_k}\\
t_{k+1} & = & t_k + h.
\end{array}
\]
Hence we can use the following \Matlab commands
\begin{verbatim}
h    = 0.1;
t(1) = 0;
x(1) = 1;
y(1) = 0;
K    = 120;
for k = 1:K
   t(k+1) = t(k)+h;
   x(k+1) = x(k)-h*y(k);
   y(k+1) = y(k)+h*x(k);
end
plot(x,y,'o')
hold on
plot(x,y,'--')
\end{verbatim}
to approximate the solution in the phase plane.  It can be observed
that the approximation obtained by Euler's method is spiraling out
rather than reproducing the circle.

(b)  The implicit Euler method applied to the given initial value
problem takes the form
\[
\begin{array}{rcl}
\vectwo{x_{k+1}}{y_{k+1}} & = &
\vectwo{x_k}{y_k} + h \vectwo{-y_{k+1}}{x_{k+1}}\\
t_{k+1} & = & t_k + h.
\end{array}
\]
We can solve these linear equations for $x_{k+1}$ and $y_{k+1}$ to obtain
\[
x_{k+1} = \frac{x_k-hy_k}{1+h^2} \AND
y_{k+1} = \frac{y_k+hx_k}{1+h^2}.
\]
Hence we can use the following \Matlab commands
\begin{verbatim}
h    = 0.1;
t(1) = 0;
x(1) = 1;
y(1) = 0;
K    = 120;
for k = 1:K
   t(k+1) = t(k)+h;
   x(k+1) = (x(k)-h*y(k))/(1+h*h);
   y(k+1) = (y(k)+h*x(k))/(1+h*h);
end
plot(x,y,'o')
hold on
plot(x,y,'--')
\end{verbatim}
to approximate the solution in the phase plane.  It can be observed
that the approximation obtained by the implicit Euler method is
spiraling in rather than reproducing the circle.




\subsection*{Section~\protect{\ref{sec:EEEM}} Error Bounds for Euler's Method}
\rhead{sec:EEEM}{ERROR BOUNDS FOR EULER'S METHOD}

\exer{c15.2.1a} \ans Local discretization error:
\[
\delta(k+1) \le
e^{3T}\frac{(3h)^2}{2} \quad \mbox{for all $h\ge 0$.}
\]
Global discretization error:
\[
|\epsilon(k)| \le e^{3T}(e^{3T}-1)\frac{3h}{2}.
\]

\soln Euler's method applied to the initial value problem takes the form
\[
\begin{array}{rclcl}
t_{k+1} & = & t_k+h & & \\
x_{k+1} & = & x_k + h 3 x_k & = & (1+3h)x_k
\end{array}
\]
where $k=0,1,\ldots,K-1$.

{\em Local error:} we assume that the
numerical solution is exact up to step $k$, that is,
we start in $x(t_k)=e^{3t_k}$.  Then the local discretization error
$\delta(k+1)$ is given by
\[
\delta(k+1) = x(t_{k+1}) - (x(t_k) + h 3x(t_k))=
e^{3t_{k+1}} - (1+3h)e^{t_k}.
\]
Since $t_k = kh$ we obtain
\[
\delta(k+1) = e^{3t_{k+1}} - (1+3h)e^{t_k} =
e^{3(k+1)h} - (1+3h)e^{3kh} = e^{3kh}(e^{3h}-(1+3h)).
\]
By definition of the exponential function
\[
e^{3h}-(1+3h) = \frac{(3h)^2}{2}+\frac{(3h)^3}{6}+\cdots =
\frac{(3h)^2}{2}\left[ 1+\frac{(3h)}{3}+\frac{(3h)^2}{12}+\cdots\right]
\le \frac{(3h)^2}{2}e^{3h}.
\]
Since $(k+1)h=(k+1)/K\le T$ for $k=0,1,\ldots,K-1$ we finally have the
desired bound on the local discretization error:
\[
\delta(k+1) = e^{3kh}(e^{3h}-(1+3h)) \le
e^{3(k+1)h}\left(\frac{(3h)^2}{2}\right)\le
e^{3T}\frac{(3h)^2}{2} \quad \mbox{for all $h\ge 0$.}
\]

{\em Global error:} we have for $k=1,2,\ldots,K$
\[
x(t_k)=(1+3h)x(t_{k-1})+\delta(k),
\]
and subtracting
\[
x_k = (1+3h)x_{k-1}
\]
leads to
\[
x(t_k) - x_k = (1+3h)(x(t_{k-1})-x_{k-1})+\delta(k).
\]
Therefore
\begin{eqnarray*}
|\epsilon(k)| & = & |x(t_k) - x_k| =
|(1+3h)(x(t_{k-1})-x_{k-1})+\delta(k)|\\
& \le & (1+3h)|\epsilon(k-1)|+\delta_h
\end{eqnarray*}
since
\[
\delta(k)\le \delta_h = e^{3T}\frac{(3h)^2}{2}.
\]
Apply this formula repeatedly until $k$ is zero,
\[
\begin{array}{rcl}
|\epsilon(k)|&\le&(1+3h)|\epsilon(k-1)|+\delta_h\\
&\le& (1+3h)[(1+3h)|\epsilon(k-2)|+\delta_h]+\delta_h\\
&=& (1+3h)^2|\epsilon(k-2)| + ((1+3h) + 1)\delta_h\\
&\le& (1+3h)^2[(1+3h)|\epsilon(k-3)|+\delta_h] + ((1+3h) + 1)\delta_h\\
&=& (1+3h)^3|\epsilon(k-3)| + ((1+3h)^2 + (1+3h) + 1)\delta_h\\
&\vdots& \\
&\le & (1+3h)^k|\epsilon(0)| + ((1+3h)^{k-1} +\cdots + (1+3h) + 1)\delta_h.
\end{array}
\]
Since $\epsilon(0)=x(t_0) - x_0=0$
\[
|\epsilon(k)| \le \frac{(1+3h)^k -1}{3h}\delta_h.
\]
With $1+3h\le e^{3h}$ we have the bound on the global discretization error:
\[
|\epsilon(k)| \le \frac{1}{3h} (e^{3kh}-1)\delta_h=
\frac{1}{3h}(e^{3kh}-1)e^{3T}\frac{(3h)^2}{2} =
e^{3T}(e^{3kh}-1)\frac{3h}{2}
\le e^{3T}(e^{3T}-1)\frac{3h}{2}.
\]

\exer{c15.2.1b} \ans Local discretization error:
\[
\delta(k+1) \le
2e^{T}\frac{h^2}{2} \quad \mbox{for all $h\ge 0$.}
\]
Global discretization error:
\[
|\epsilon(k)| \le 2e^{T}(e^{T}-1)\frac{h}{2}.
\]

\soln Euler's method applied to the initial value problem takes the form
\[
\begin{array}{rclcl}
t_{k+1} & = & t_k+h & & \\
x_{k+1} & = & x_k + h x_k & = & (1+h)x_k
\end{array}
\]
where $k=0,1,\ldots,K-1$.

{\em Local error:} we assume that the
numerical solution is exact up to step $k$, that is,
we start in $x(t_k)=2e^{t_k}$.  Then the local discretization error
$\delta(k+1)$ is given by
\[
\delta(k+1) = x(t_{k+1}) - (x(t_k) + h x(t_k))=
2e^{t_{k+1}} - (1+h)2e^{t_k}.
\]
Since $t_k = kh$ we obtain
\[
\delta(k+1) = 2e^{t_{k+1}} - (1+h)2e^{t_k} =
2e^{(k+1)h} - (1+h)2e^{kh} = 2e^{kh}(e^{h}-(1+h)).
\]
By definition of the exponential function
\[
e^{h}-(1+h) \le \frac{h^2}{2}e^{h}.
\]
Since $(k+1)h=(k+1)/K\le T$ for $k=0,1,\ldots,K-1$ we finally have the
desired bound on the local discretization error:
\[
\delta(k+1) = 2e^{kh}(e^{h}-(1+h)) \le
2e^{(k+1)h}\left(\frac{h^2}{2}\right)\le
2e^{T}\frac{h^2}{2} \quad \mbox{for all $h\ge 0$.}
\]

{\em Global error:} we have for $k=1,2,\ldots,K$
\[
x(t_k)=(1+h)x(t_{k-1})+\delta(k),
\]
and subtracting
\[
x_k = (1+h)x_{k-1}
\]
leads to
\[
x(t_k) - x_k = (1+h)(x(t_{k-1})-x_{k-1})+\delta(k).
\]
Therefore
\begin{eqnarray*}
|\epsilon(k)| & = & |x(t_k) - x_k| =
|(1+h)(x(t_{k-1})-x_{k-1})+\delta(k)|\\
& \le & (1+h)|\epsilon(k-1)|+\delta_h
\end{eqnarray*}
since
\[
\delta(k)\le \delta_h = 2e^{T}\frac{h^2}{2}.
\]
Apply this formula repeatedly until $k$ is zero,
\[
\begin{array}{rcl}
|\epsilon(k)|&\le&(1+h)|\epsilon(k-1)|+\delta_h\\
&\le& (1+h)[(1+h)|\epsilon(k-2)|+\delta_h]+\delta_h\\
&=& (1+h)^2|\epsilon(k-2)| + ((1+h) + 1)\delta_h\\
&\le& (1+h)^2[(1+h)|\epsilon(k-3)|+\delta_h] + ((1+h) + 1)\delta_h\\
&=& (1+h)^3|\epsilon(k-3)| + ((1+h)^2 + (1+h) + 1)\delta_h\\
&\vdots& \\
&\le & (1+h)^k|\epsilon(0)| + ((1+h)^{k-1} +\cdots + (1+h) + 1)\delta_h.
\end{array}
\]
Since $\epsilon(0)=x(t_0) - x_0=0$
\[
|\epsilon(k)| \le \frac{(1+h)^k -1}{h}\delta_h.
\]
With $1+h\le e^{h}$ we have the bound on the global discretization error:
\[
|\epsilon(k)| \le \frac{1}{h} (e^{kh}-1)\delta_h=
\frac{1}{h}(e^{kh}-1)2e^{T}\frac{h^2}{2} =
2e^{T}(e^{kh}-1)\frac{h}{2}
\le 2e^{T}(e^{T}-1)\frac{h}{2}.
\]


\exer{c15.2.1c} \ans Local discretization error:
\[
\delta(k+1) \le
2e^{3T}\frac{(3h)^2}{2} \quad \mbox{for all $h\ge 0$.}
\]
Global discretization error:
\[
|\epsilon(k)| \le 2e^{3T}(e^{3T}-1)\frac{3h}{2}.
\]

\soln Euler's method applied to the initial value problem takes the form
\[
\begin{array}{rclcl}
t_{k+1} & = & t_k+h & & \\
x_{k+1} & = & x_k + h 3x_k & = & (1+3h)x_k
\end{array}
\]
where $k=0,1,\ldots,K-1$.

{\em Local error:} we assume that the
numerical solution is exact up to step $k$, that is,
we start in $x(t_k)=2e^{3t_k}$.  Then the local discretization error
$\delta(k+1)$ is given by
\[
\delta(k+1) = x(t_{k+1}) - (x(t_k) + h 3 x(t_k))=
2e^{3t_{k+1}} - (1+3h)2e^{3t_k}.
\]
Since $t_k = kh$ we obtain
\[
\delta(k+1) = 2e^{3t_{k+1}} - (1+3h)2e^{3t_k} =
2e^{3(k+1)h} - (1+3h)2e^{3kh} = 2e^{3kh}(e^{3h}-(1+3h)).
\]
By definition of the exponential function
\[
e^{3h}-(1+3h) = \frac{(3h)^2}{2}+\frac{(3h)^3}{6}+\cdots =
\frac{(3h)^2}{2}\left[ 1+\frac{(3h)}{3}+\frac{(3h)^2}{12}+\cdots\right]
\le \frac{(3h)^2}{2}e^{3h}.
\]
Since $(k+1)h=(k+1)/K\le T$ for $k=0,1,\ldots,K-1$ we finally have the
desired bound on the local discretization error:
\[
\delta(k+1) = 2e^{3kh}(e^{3h}-(1+3h)) \le
2e^{3(k+1)h}\left(\frac{(3h)^2}{2}\right)\le
2e^{3T}\frac{(3h)^2}{2} \quad \mbox{for all $h\ge 0$.}
\]

{\em Global error:} we have for $k=1,2,\ldots,K$
\[
x(t_k)=(1+3h)x(t_{k-1})+\delta(k),
\]
and subtracting
\[
x_k = (1+3h)x_{k-1}
\]
leads to
\[
x(t_k) - x_k = (1+3h)(x(t_{k-1})-x_{k-1})+\delta(k).
\]
Therefore
\begin{eqnarray*}
|\epsilon(k)| & = & |x(t_k) - x_k| =
|(1+3h)(x(t_{k-1})-x_{k-1})+\delta(k)|\\
& \le & (1+3h)|\epsilon(k-1)|+\delta_h
\end{eqnarray*}
since
\[
\delta(k)\le \delta_h = 2e^{3T}\frac{(3h)^2}{2}.
\]
Apply this formula repeatedly until $k$ is zero,
\[
\begin{array}{rcl}
|\epsilon(k)|&\le&(1+3h)|\epsilon(k-1)|+\delta_h\\
&\le& (1+3h)[(1+3h)|\epsilon(k-2)|+\delta_h]+\delta_h\\
&=& (1+3h)^2|\epsilon(k-2)| + ((1+3h) + 1)\delta_h\\
&\le& (1+3h)^2[(1+3h)|\epsilon(k-3)|+\delta_h] + ((1+3h) + 1)\delta_h\\
&=& (1+3h)^3|\epsilon(k-3)| + ((1+3h)^2 + (1+3h) + 1)\delta_h\\
&\vdots& \\
&\le & (1+3h)^k|\epsilon(0)| + ((1+3h)^{k-1} +\cdots + (1+3h) + 1)\delta_h.
\end{array}
\]
Since $\epsilon(0)=x(t_0) - x_0=0$
\[
|\epsilon(k)| \le \frac{(1+3h)^k -1}{3h}\delta_h.
\]
With $1+3h\le e^{3h}$ we have the bound on the global discretization error:
\[
|\epsilon(k)| \le \frac{1}{3h} (e^{3kh}-1)\delta_h=
\frac{1}{3h}(e^{3kh}-1)2e^{3T}\frac{(3h)^2}{2} =
2e^{3T}(e^{3kh}-1)\frac{3h}{2}
\le 2e^{3T}(e^{3T}-1)\frac{3h}{2}.
\]

\exer{c15.2.2} \ans Local discretization error:
\[
\delta(k+1) = e^{t_{k+1}} - \frac{1}{1-h} e^{t_k}.
\]

\soln The implicit Euler method applied to the initial value problem
\Ref{eq:simplest} takes the form
\[
\begin{array}{rclc}
t_{k+1} & = & t_k+h & \\
x_{k+1} & = & x_k + h x_{k+1} &
\end{array}
\]
where $k=0,1,\ldots,K-1$.  Solving for $x_{k+1}$ yields
\[
x_{k+1} = \frac{1}{1-h}x_k.
\]
We assume that the numerical solution is exact up to step $k$, that is,
we start in $x(t_k)=e^{t_k}$.  Then the local discretization error
$\delta(k+1)$ is given by
\[
\delta(k+1) = x(t_{k+1}) - \frac{1}{1-h}x(t_k)=
e^{t_{k+1}} - \frac{1}{1-h}e^{t_k}.
\]

\exer{c15.2.3a} \ans $h=0.0014$.

\soln Using the bound on the global discretization error
given in Proposition~\ref{prop:globerr1} we can choose a
step length $h$ satisfying
\[
e^4(e^4-1)\frac{h}{2} = 2,
\]
or, equivalently,
\[
h = \frac{4}{e^4(e^4-1)} \approx 0.0014.
\]
Now $4/h \approx 2927$, and we can verify our result using the
following \Matlab commands:
\begin{verbatim}
h      = 0.0014;
t(1)   = 0;
x(1)   = 1;
err(1) = 0;
est(1) = 0;
K      = 2927;
for k = 1:K
    t(k+1) = t(k)+h;
    x(k+1) = (1+h)*x(k);
  err(k+1) = exp(t(k+1))-x(k+1);
end
plot(t,err)
xlabel('t')
ylabel('global error')
\end{verbatim}
Indeed, by this choice of $h$ the error is always smaller than $0.18$.


\exer{c15.2.3b} \ans $h=0.000914$.

\soln Using the bound on the global discretization error
given in Proposition~\ref{prop:globerr1} we can choose a
step length $h$ satisfying
\[
e^{5}(e^{5}-1)\frac{h}{2} = 10,
\]
or, equivalently,
\[
h = \frac{20}{e^{5}(e^{5}-1)} \approx 0.000914.
\]
Now $5/h \approx 5470$, and we can verify our result using the
following \Matlab commands:
\begin{verbatim}
h      = 0.000914;
t(1)   = 0;
x(1)   = 1;
err(1) = 0;
est(1) = 0;
K      = 5470;
for k = 1:K
    t(k+1) = t(k)+h;
    x(k+1) = (1+h)*x(k);
  err(k+1) = exp(t(k+1))-x(k+1);
end
plot(t,err)
xlabel('t')
ylabel('global error')
\end{verbatim}
Indeed, by this choice of $h$ the error is always smaller than $0.35$.


\exer{c15.2.4} \ans $T=1.609$.

\soln Using the bound on the global discretization error
given in Proposition~\ref{prop:globerr1} we can choose
$T$ satisfying
\[
e^{T}(e^{T}-1)\frac{0.005}{2} = 0.05,
\]
or, equivalently,
\[
e^{2T} - e^T - 20 = 0.
\]
Solving this quadratic equation in $e^T$ leads to the positive
solution
\[
e^T = 5 \Rightarrow T \approx 1.609.
\]
Now $T/h \approx 321$, and we can verify our result using the
following \Matlab commands:
\begin{verbatim}
h      = 0.005;
t(1)   = 0;
x(1)   = 1;
err(1) = 0;
est(1) = 0;
K      = 321;
for k = 1:K
    t(k+1) = t(k)+h;
    x(k+1) = (1+h)*x(k);
  err(k+1) = exp(t(k+1))-x(k+1);
end
plot(t,err)
xlabel('t')
ylabel('global error')
\end{verbatim}
Indeed, by this choice of $T$ the error is smaller than $0.02$.


\subsection*{Section~\protect{\ref{sec:LGEE}} Local and Global Error Bounds}
\rhead{sec:LGEE}{LOCAL AND GLOBAL ERROR BOUNDS}


\exer{c15.3.1} \ans
\begin{eqnarray*}
\Phi(t_k,x_k,h) & = & \frac{1}{6}\Big[f(t_k,x_k)+\\
&&2f\left(t_k+\frac{h}{2},x_k+\frac{h}{2}f(t_k,x_k)\right) +\\
&&2f\left(t_k+\frac{h}{2},x_k+
  \frac{h}{2}f\left(t_k+\frac{h}{2},x_k+\frac{h}{2}f(t_k,x_k)\right)\right)+\\
&&\left.f\left(t_k+h,x_k+hf\left(t_k+\frac{h}{2},x_k+
  \frac{h}{2}f\left(t_k+\frac{h}{2},x_k+
  \frac{h}{2}f(t_k,x_k)\right)\right)\right)\right]
\end{eqnarray*}

\soln The fourth order Runge-Kutta method is given by
\[
x_{k+1} = x_k+\frac{h}{6}(f_1+2f_2+2f_3+f_4),
\]
where
\begin{eqnarray*}
f_1 &=& f(t_k,x_k)\\
f_2 &=& f\left(t_k+\frac{h}{2},x_k+\frac{h}{2}f_1\right)\\
f_3 &=& f\left(t_k+\frac{h}{2},x_k+\frac{h}{2}f_2\right)\\
f_4 &=& f(t_k+h,x_k+hf_3).
\end{eqnarray*}
The result follows by inserting these expressions for $f_1,\ldots,f_4$.

\exer{c15.3.2a} \ans $C_E \le \frac{9}{2}x(T)$.

\soln We want to use \Ref{eq:CE} and compute
\[
\frac{\partial f}{\partial t}(t,x)=0\AND
\frac{\partial f}{\partial x}(t,x)=3.
\]
Since the solution of the initial value problem is monotonically
increasing we find that
\[
C_E\le \frac{1}{2}\max\left\{ \left\vert 0+3\cdot 3y\right\vert,
2\le y\le x(T) \right\} = \frac{9}{2}x(T).
\]

\exer{c15.3.2b} \ans $C_E \le \frac{1}{2}x(0)=\frac{1}{2}$.

\soln We want to use \Ref{eq:CE} and compute
\[
\frac{\partial f}{\partial t}(t,x)=0\AND
\frac{\partial f}{\partial x}(t,x)=-1.
\]
Since the solution of the initial value problem is monotonically
decreasing while staying positive we find that
\[
C_E\le \frac{1}{2}\max\left\{ \left\vert 0+y\right\vert,
0<y\le x(0) \right\} = \frac{1}{2}x(0)=\frac{1}{2}.
\]


\exer{c15.3.3}
Proceeding as in the text we use the \Matlab commands
\begin{verbatim}
h      = 0.1;
L      = 0.2;
t(1)   = 0;
x(1)   = 1;
err(1) = 0;
est(1) = 0;
K      = 1/h;
for k = 1:K
     t(k+1) = t(k)+h;
     x(k+1) = (1+L*h)*x(k);
   err(k+1) = exp(L*t(k+1))-x(k+1);
   est(k+1) = exp(L)*(exp(L*k*h)-1)*L*h/2;
end
plot(t,err,'+')
hold on
plot(t,est,'x')
\end{verbatim}
to derive the desired result.  It can be seen that in this case
the error is significantly smaller than in Figures~\ref{fig:globerr1}
and \ref{fig:Lgeest} due to the fact that here $L=0.2$ is smaller
than in those cases.  In fact, the error is bounded by $0.003$.



