\documentclass{ximera}

\input{../preamble.tex}

\title{Matrix Multiplication of Vectors}

\begin{document}
\begin{abstract}
\end{abstract}
\maketitle

 \label{S:4.1}
\index{matrix!multiplication}

In Chapter~\ref{lineq} we discussed how matrices appear when solving systems 
of $m$ linear equations in $n$ unknowns.  Given the system
\begin{equation}   \label{general2}
\arraycolsep 2pt
\begin{array}{rcrcrcrcrl}
a_{11}x_1 & + & a_{12}x_2 & + & \cdots & + & a_{1n}x_n & = & b_1 & \\
a_{21}x_1 & + & a_{22}x_2 & + & \cdots & + & a_{2n}x_n & = & b_2 & \\
    & \vdots &      & \vdots &    & \vdots &     & \vdots &   & \\
a_{m1}x_1 & + & a_{m2}x_2 & + & \cdots & + & a_{mn}x_n & = & b_m & ,
\end{array}
\end{equation}
we saw that all relevant information is contained in the $m\times n$ matrix 
of coefficients
\[
A=\left(
\begin{array}{rrrr}
 a_{11} & a_{12} & \cdots & a_{1n} \\
 a_{21} & a_{22} & \cdots & a_{2n}  \\
 \vdots & \vdots &        & \vdots  \\
 a_{m1} & a_{m2} & \cdots & a_{mn}
\end{array}
\right)
\]
and the $m$ vector
\[
b=\left(
\begin{array}{c}
b_1 \\ \vdots \\ b_m
\end{array}
\right).
\]



\subsection*{Matrices Times Vectors}

We motivate multiplication of a matrix times a vector just as a notational 
advance that simplifies the
presentation of the linear systems.  It is, however, much more
than that.  This concept of multiplication allows us to think of
matrices as mappings and these mappings tell us much about the
structure of solutions to linear systems.  But first we discuss
the notational advantage.

Multiplying an $m\times n$ matrix $A$ times an $n$ vector $x$
\index{matrix vector product}
produces an $m$ vector, as follows:
\begin{equation}  \label{Atimesx}
\scriptstyle Ax=\left(
\begin{array}{ccc}
 a_{11}  & \cdots & a_{1n} \\
 \vdots  &        & \vdots  \\
 a_{m1}  & \cdots & a_{mn}
\end{array}
\right)
\left(
\begin{array}{c}
x_1 \\ \vdots \\ x_n
\end{array}
\right)
=
\left(
\begin{array}{c}
a_{11}x_1 + \cdots + a_{1n}x_n \\ \vdots \\
a_{m1}x_1 + \cdots + a_{mn}x_n
\end{array}
\right).
\end{equation}
For example, when $m=2$ and $n=3$, then the product is a $2$-vector
\begin{equation} \label{Atimesx231}
{\scriptstyle
\left(
\begin{array}{ccc}
 a_{11}  & a_{12} & a_{13} \\
 a_{21}  & a_{22} & a_{23}
\end{array}
\right)
\left(
\begin{array}{c}
x_1 \\ x_2 \\ x_3
\end{array}
\right)
=
\left(
\begin{array}{c}
a_{11}x_1 + a_{12}x_2 + a_{13}x_3 \\
a_{21}x_1 + a_{22}x_2 + a_{23}x_3
\end{array}
\right).
}
\end{equation}
As a specific example, compute
\begin{align*}
\left(
\begin{matrix}
 2  & 3 & -1 \\
 4  & 1 &  5
\end{matrix}
\right)
\left(
\begin{matrix}
2 \\ -3 \\ 4
\end{matrix}
\right)
&=
\left(
\begin{matrix}
2\cdot 2 & + & 3\cdot(-3) & + & (-1)\cdot 4 \\
4\cdot 2 & + & 1\cdot(-3) & + & 5\cdot 4
\end{matrix}
\right) \\
&=
\left(
\begin{matrix}
-9 \\ 25
\end{matrix}
\right).
\end{align*}


Using \eqref{Atimesx} we have a compact notation for writing
systems of linear equations.  For example, using a special
instance of \eqref{Atimesx231},
\[
\left(
\begin{array}{rrr}
 2  & 3 & -1 \\
 4  & 1 &  5
\end{array}
\right)
\left(
\begin{array}{r}
x_1 \\ x_2 \\ x_3
\end{array}
\right)
=
\left(
\begin{array}{c}
2x_1 + 3x_2 - x_3 \\
4x_1 + x_2 + 5x_3
\end{array}
\right).
\]
In this notation we can write the system of two linear equations
in three unknowns
\[
\begin{array}{ccccccr}
2x_1 & + & 3x_2 & - &  x_3 & = &   2 \\
4x_1 & + &  x_2 & + & 5x_3 & = &  -1
\end{array}
\]
as the matrix equation
\[
\left(
\begin{array}{rrr}
 2  & 3 & -1 \\
 4  & 1 &  5
\end{array}
\right)
\left(
\begin{array}{r}
x_1 \\ x_2 \\ x_3
\end{array}
\right)
=
\left(
\begin{array}{r}
2 \\ -1
\end{array}
\right).
\]

Indeed, the general system of linear equations \eqref{general2}
can be written in matrix form using matrix multiplication as
\[
Ax=b
\]
where $A$ is the $m\times n$ matrix of coefficients, $x$ is the
$n$ vector of unknowns, and $b$ is the $m$ vector of constants
on the right hand side of \eqref{general2}.


\subsection*{Matrices Times Vectors in \Matlab}

We have already seen how to define matrices and vectors in
\Matlabp.  Now we show how to multiply a matrix times a vector
using \Matlabp\index{matrix vector product!in \protect\Matlab}.

Load the matrix $A$
\begin{matlabEquation}  \label{eq:5matrix}
A=\left(
\begin{array}{rrrrr}
 5 & -4 &  3 & -6 &  2 \\
 2 & -4 & -2 & -1 &  1 \\
 1 &  2 &  1 & -5 &  3 \\
-2 & -1 & -2 &  1 & -1 \\
 1 & -6 &  1 &  1 &  4
\end{array}
\right)
\end{matlabEquation}
and the vector $x$
\begin{matlabEquation} \label{eq:5rhs}
x=\left(
\begin{array}{r}
 -1 \\
  2 \\
  1 \\
 -1 \\
  3
\end{array}
\right)
\end{matlabEquation}
into \Matlab by typing
\begin{verbatim}
e3_1_4
e3_1_5
\end{verbatim}
The multiplication $Ax$ can be performed by typing
\begin{verbatim}
b = A*x
\end{verbatim}  \index{\computer!*}
and the result should be
\begin{verbatim}
b =
     2
    -8
    18
    -6
    -1
\end{verbatim}
We may verify this result by solving the system of linear
equations $Ax=b$.  Indeed if we type
\begin{verbatim}
A\b
\end{verbatim}  \index{\computer!$\backslash$}
then we get the vector $x$ back as the answer.



\includeexercises


\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
